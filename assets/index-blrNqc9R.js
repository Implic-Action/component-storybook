import{r,a as B}from"./index-CTjT7uj6.js";import{c as k,d as y,a as h}from"./index-Bw8lNzcd.js";import{$ as _,_ as U}from"./index-DnkvmRqu.js";import{$ as z,a as A}from"./index-CD4l4TuI.js";const K=B.useId||(()=>{});let N=0;function Z(s){const[e,i]=r.useState(K());return k(()=>{i(t=>t??String(N++))},[s]),e?`radix-${e}`:""}function H(s,e=globalThis==null?void 0:globalThis.document){const i=y(s);r.useEffect(()=>{const t=n=>{n.key==="Escape"&&i(n)};return e.addEventListener("keydown",t),()=>e.removeEventListener("keydown",t)},[i,e])}const p="dismissableLayer.update",X="dismissableLayer.pointerDownOutside",j="dismissableLayer.focusOutside";let w;const q=r.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ee=r.forwardRef((s,e)=>{var i;const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:c,onFocusOutside:b,onInteractOutside:u,onDismiss:l,...v}=s,a=r.useContext(q),[d,C]=r.useState(null),f=(i=d==null?void 0:d.ownerDocument)!==null&&i!==void 0?i:globalThis==null?void 0:globalThis.document,[,L]=r.useState({}),F=_(e,o=>C(o)),O=Array.from(a.layers),[R]=[...a.layersWithOutsidePointerEventsDisabled].slice(-1),I=O.indexOf(R),D=d?O.indexOf(d):-1,S=a.layersWithOutsidePointerEventsDisabled.size>0,P=D>=I,W=G(o=>{const $=o.target,g=[...a.branches].some(E=>E.contains($));!P||g||(c==null||c(o),u==null||u(o),o.defaultPrevented||l==null||l())},f),m=J(o=>{const $=o.target;[...a.branches].some(E=>E.contains($))||(b==null||b(o),u==null||u(o),o.defaultPrevented||l==null||l())},f);return H(o=>{D===a.layers.size-1&&(n==null||n(o),!o.defaultPrevented&&l&&(o.preventDefault(),l()))},f),r.useEffect(()=>{if(d)return t&&(a.layersWithOutsidePointerEventsDisabled.size===0&&(w=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),a.layersWithOutsidePointerEventsDisabled.add(d)),a.layers.add(d),T(),()=>{t&&a.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=w)}},[d,f,t,a]),r.useEffect(()=>()=>{d&&(a.layers.delete(d),a.layersWithOutsidePointerEventsDisabled.delete(d),T())},[d,a]),r.useEffect(()=>{const o=()=>L({});return document.addEventListener(p,o),()=>document.removeEventListener(p,o)},[]),r.createElement(z.div,U({},v,{ref:F,style:{pointerEvents:S?P?"auto":"none":void 0,...s.style},onFocusCapture:h(s.onFocusCapture,m.onFocusCapture),onBlurCapture:h(s.onBlurCapture,m.onBlurCapture),onPointerDownCapture:h(s.onPointerDownCapture,W.onPointerDownCapture)}))});function G(s,e=globalThis==null?void 0:globalThis.document){const i=y(s),t=r.useRef(!1),n=r.useRef(()=>{});return r.useEffect(()=>{const c=u=>{if(u.target&&!t.current){let v=function(){x(X,i,l,{discrete:!0})};const l={originalEvent:u};u.pointerType==="touch"?(e.removeEventListener("click",n.current),n.current=v,e.addEventListener("click",n.current,{once:!0})):v()}else e.removeEventListener("click",n.current);t.current=!1},b=window.setTimeout(()=>{e.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(b),e.removeEventListener("pointerdown",c),e.removeEventListener("click",n.current)}},[e,i]),{onPointerDownCapture:()=>t.current=!0}}function J(s,e=globalThis==null?void 0:globalThis.document){const i=y(s),t=r.useRef(!1);return r.useEffect(()=>{const n=c=>{c.target&&!t.current&&x(j,i,{originalEvent:c},{discrete:!1})};return e.addEventListener("focusin",n),()=>e.removeEventListener("focusin",n)},[e,i]),{onFocusCapture:()=>t.current=!0,onBlurCapture:()=>t.current=!1}}function T(){const s=new CustomEvent(p);document.dispatchEvent(s)}function x(s,e,i,{discrete:t}){const n=i.originalEvent.target,c=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:i});e&&n.addEventListener(s,e,{once:!0}),t?A(n,c):n.dispatchEvent(c)}export{ee as $,Z as a};
